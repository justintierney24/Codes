SELECT t.prospect_id,
t.Full_Name,
t.First_Name,
t.prospect_enum,
t.Admit_date,
t.prospect_enroll_semester,
t.prospect_type_name,
t.prospect_street,
t.THIRDLINE,
t.academic_contact_name,
t.academic_contact_email,
t.URL,
t.dept_id,
t.Department_name_official,
t.College_name_official,
REPLACE(t.academic_admit_letter,'</p>','') AS academic_admit_letter,
t.academic_admit_letter_clean,
t.academic_name
FROM (SELECT s.prospect_id,
s.Full_Name,
s.First_Name,
s.prospect_enum,
s.Admit_date,
s.prospect_enroll_semester,
s.prospect_type_name,
s.prospect_street,
s.THIRDLINE,
s.academic_contact_name,
s.academic_contact_email,
s.URL,
s.dept_id,
s.Department_name_official,
s.College_name_official,
REPLACE(s.academic_admit_letter,'<p>','') AS academic_admit_letter,
s.academic_admit_letter_clean,
s.academic_name
FROM (SELECT r.prospect_id,
r.Full_Name,
r.First_Name,
r.prospect_enum,
r.Admit_date,
r.prospect_enroll_semester,
r.prospect_type_name,
r.prospect_street,
r.THIRDLINE,
r.academic_contact_name,
r.academic_contact_email,
r.URL,
r.dept_id,
r.Department_name_official,
r.College_name_official,
REPLACE(r.academic_admit_letter,'</p>','</p>\r\n<p> </p>') AS academic_admit_letter,
r.academic_admit_letter_clean,
r.academic_name
FROM (SELECT q.prospect_id,
q.Full_Name,
q.First_Name,
q.prospect_enum,
q.Admit_date,
q.prospect_enroll_semester,
q.prospect_type_name,
q.prospect_street,
q.THIRDLINE,
q.academic_contact_name,
q.academic_contact_email,
q.URL,
q.dept_id,
q.Department_name_official,
q.College_name_official,
REPLACE(q.academic_admit_letter,'&ndash;','\–') AS academic_admit_letter,
REPLACE(q.academic_admit_letter_clean,'&ndash;','-') AS academic_admit_letter_clean,
q.academic_name
FROM (SELECT p.prospect_id,
p.Full_Name,
p.First_Name,
p.prospect_enum,
p.Admit_date,
p.prospect_enroll_semester,
p.prospect_type_name,
p.prospect_street,
p.THIRDLINE,
p.academic_contact_name,
p.academic_contact_email,
p.URL,
p.dept_id,
p.Department_name_official,
p.College_name_official,
REPLACE(p.academic_admit_letter,'&mdash;','\’97') AS academic_admit_letter,
REPLACE(p.academic_admit_letter_clean,'&mdash;','-') AS academic_admit_letter_clean,
p.academic_name
FROM (SELECT o.prospect_id,
o.Full_Name,
o.First_Name,
o.prospect_enum,
o.Admit_date,
o.prospect_enroll_semester,
o.prospect_type_name,
o.prospect_street,
o.THIRDLINE,
o.academic_contact_name,
o.academic_contact_email,
o.URL,
o.dept_id,
o.Department_name_official,
o.College_name_official,
REPLACE(o.academic_admit_letter,'&nbsp;',' ') AS academic_admit_letter,
REPLACE(o.academic_admit_letter_clean,'&nbsp;',' ') AS academic_admit_letter_clean,
o.academic_name
FROM (SELECT n.prospect_id,
n.Full_Name,
n.First_Name,
n.prospect_enum,
n.Admit_date,
n.prospect_enroll_semester,
n.prospect_type_name,
n.prospect_street,
n.THIRDLINE,
n.academic_contact_name,
n.academic_contact_email,
n.URL,
n.dept_id,
n.Department_name_official,
n.College_name_official,
REPLACE(n.academic_admit_letter,'&ldquo;','"') AS academic_admit_letter,
REPLACE(n.academic_admit_letter_clean,'&ldquo;','"') AS academic_admit_letter_clean,
n.academic_name
FROM (SELECT DISTINCT m.prospect_id,
m.Full_Name,
m.First_Name,
m.prospect_enum,
m.Admit_date,
m.prospect_enroll_semester,
m.prospect_type_name,
m.prospect_street,
m.THIRDLINE,
m.academic_contact_name,
m.academic_contact_email,
TRIM('https://' FROM m.url2) AS URL,
m.dept_id,
m.Department_name_official,
m.College_name_official,
REPLACE(m.academic_admit_letter,'&rdquo;','"') AS academic_admit_letter,
REPLACE(m.academic_admit_letter_clean,'&rdquo;','"') AS academic_admit_letter_clean,
m.academic_name
FROM (SELECT DISTINCT i.prospect_id,
i.Full_Name,
i.prospect_fname AS First_Name,
i.prospect_enum,
i.Admit_date,
i.prospect_enroll_semester,
i.prospect_type_name,
i.prospect_street,
i.THIRDLINE,
j.academic_contact_name,
j.academic_contact_email,
TRIM('http://' FROM j.academic_url) AS URL2,
j.dept_id,
j.Department_name_official,
j.College_name_official,
REPLACE(j.academic_admit_letter,'&lsquo;','''') AS academic_admit_letter,
REPLACE(j.academic_admit_letter_clean,'&lsquo;','''') AS academic_admit_letter_clean,
i.prospect_program_code,
j.academic_banner_program_code,
i.selected_major,
j.academic_id,
j.academic_name
FROM (SELECT DISTINCT g.prospect_id,
h.prospect_enum,
g.prospect_fname,
CONCAT(g.prospect_fname_legal,' ',g.prospect_lname) AS Full_Name,
DATE(g.prospect_banner_admitted) AS Admit_date,
g.prospect_street,
CONCAT(g.prospect_city,', ',g.prospect_state,' ',g.prospect_zip) AS THIRDLINE,
h.prospect_major_code,
g.prospect_enroll_semester,
k.prospect_type_name,
h.prospect_program_code,
l.academic_id,
l.selected_major
FROM prospects g
JOIN prospect_appl_data h
ON g.prospect_id = h.prospect_id
JOIN prospect_types k
ON g.prospect_type = k.prospect_type_id
LEFT JOIN prospect_academic l
ON g.prospect_id = l.prospect_id
JOIN academics m
ON l.academic_id = m.academic_id
WHERE g.prospect_type IN (1,6)
AND g.prospect_status = 2
AND l.selected_major = 1
AND g.prospect_street <> ' ') i
JOIN (SELECT a.academic_banner_program_code,
a.academic_id,
a.academic_banner_major,
a.academic_name,
a.academic_contact_name,
a.academic_contact_email,
a.academic_url,
CASE WHEN d.dept_id = 6 THEN CONCAT('School of ',d.dept_name) WHEN f.college_id IN (1,3,4) THEN CONCAT('Department of ',d.dept_name) ELSE d.dept_name END AS Department_name_official,
CASE WHEN f.college_id IN (1,3,4) THEN CONCAT('College of ',f.college_name) ELSE f.college_name END AS College_name_official,
d.dept_id,
REPLACE(a.academic_admit_letter,'&rsquo;','''') AS academic_admit_letter,
REPLACE(a.academic_admit_letter_clean,'&rsquo;','''') AS academic_admit_letter_clean
FROM majors_minors.academics a
LEFT JOIN majors_minors.academics_departments c
ON c.academic_id = a.academic_id
LEFT JOIN majors_minors.departments d
ON d.dept_id = c.dept_id
LEFT JOIN majors_minors.academics_colleges e
ON e.academic_id = a.academic_id
LEFT JOIN majors_minors.colleges f
ON f.college_id = e.college_id
WHERE a.degree_level_id = 1) j
ON i.academic_id = j.academic_id
WHERE i.Admit_date >= :DateEdit1) m) n) o) p) q) r) s) t
ORDER BY 18
